<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<meta name="color-scheme" content="light dark">
<title>Game Changers: Immunity Challenge</title>

<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@400;700&family=Montserrat:wght@500;700&display=swap" rel="stylesheet">

<style>
/* ========== ANCHOR: THEME ========== */
:root{
  --bg:#0c1a14; --bg2:#0e231a;
  --sand:#e0cfa4; --ink:#1c1206; --lightink:#f7f3ea; --muted:#cbbd97;
  --accent:#3ac47d; --accent2:#1ba6e0; --fire:#ff8a00; --bad:#ff6b6b;
  --grid:#2d4a3d; --rope:#c9a86a; --wood1:#6b3e1e; --wood2:#90562a;
  --ln-blue:#0a66c2; --ln-ink:#1f2328; --ln-muted:#666d76; --ln-bg:#f3f2ef; --ln-card:#fff; --ln-border:#e0e3e7;
}
*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
html{scroll-behavior:smooth;-webkit-text-size-adjust:100%}
body{
  margin:0; color:var(--lightink);
  font:16px/1.6 Montserrat, system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";
  background:
    radial-gradient(1200px 700px at 80% -100px, rgba(27,166,224,.18), transparent 60%),
    radial-gradient(1000px 600px at -10% 120%, rgba(58,196,125,.15), transparent 60%),
    linear-gradient(180deg, var(--bg) 0%, var(--bg2) 100%);
}
.wrap{max-width:720px;margin:0 auto;padding:1.25rem 1rem 5.5rem}

header{text-align:center;margin:0 0 .5rem}
header h1{
  margin:.25rem 0 .3rem; font-family:"Cinzel Decorative", Georgia, serif;
  letter-spacing:.03em; font-size:clamp(1.6rem,5.6vw,2.2rem);
  text-shadow:0 2px 0 rgba(0,0,0,.25), 0 6px 22px rgba(0,0,0,.35);
}
header .sub{color:var(--muted); margin:.25rem auto .35rem}
header::before{
  content:"OUTWIT  ‚Ä¢  OUTPLAY  ‚Ä¢  OUTLAST";
  display:inline-block; margin:.25rem auto .35rem; padding:.35rem .9rem;
  font-weight:700; font-size:.78rem; letter-spacing:.18em;
  color:#082314; background:linear-gradient(180deg,#f5e5be,#d9c28f);
  border-radius:999px; border:2px solid rgba(0,0,0,.25);
  box-shadow:inset 0 0 0 2px rgba(255,255,255,.25), 0 6px 18px rgba(0,0,0,.35);
}

.card{
  position:relative; background:
    linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02)),
    radial-gradient(600px 220px at 50% -10%, rgba(255,255,255,.08), transparent 60%);
  border-radius:18px; padding:1rem 1rem; margin:.9rem 0;
  box-shadow:0 16px 35px rgba(0,0,0,.35);
  border:10px solid transparent;
  border-image:repeating-linear-gradient(45deg, var(--rope) 0 8px, #b38e54 8px 16px) 10;
}
.stage{display:none}
.stage.active{display:block}

.small{color:var(--muted)}
.ok{color:#7ef7b0} .bad{color:#ff6b6b}
.row{display:grid;grid-template-columns:1fr 1fr auto;gap:.6rem;margin-top:.8rem}

/* Stage 3 stacked inputs */
#stage3 .row{grid-template-columns:1fr auto}
#stage3 .row:first-of-type{grid-template-columns:1fr}

input[type=text], input[type=number]{
  width:100%; min-height:48px; padding:.9rem .95rem; font-size:1rem; outline:none; color:#f4f0e4;
  background:
    linear-gradient(180deg, rgba(0,0,0,.15), rgba(0,0,0,.28)),
    repeating-linear-gradient(90deg, rgba(255,255,255,.06) 0 10px, rgba(0,0,0,.06) 10px 20px);
  border:1px solid rgba(255,255,255,.18); border-radius:12px; box-shadow:inset 0 1px 2px rgba(0,0,0,.35);
}
input::placeholder{color:rgba(250,245,235,.6)}

button{
  border:0; min-height:48px; padding:1rem 1.1rem; font-weight:800; font-size:1rem; cursor:pointer;
  color:#fff; text-shadow:0 1px 0 rgba(0,0,0,.35);
  background:
    linear-gradient(180deg, rgba(255,255,255,.12), rgba(0,0,0,.12)),
    linear-gradient(180deg, var(--wood2), var(--wood1));
  border-radius:12px;
  box-shadow:inset 0 0 0 1px rgba(255,255,255,.15), 0 8px 18px rgba(0,0,0,.35), 0 0 0 3px rgba(27,166,224,.18);
  transition:transform .04s ease, box-shadow .2s ease;
}
button:active{transform:translateY(1px)}
.mutebtn{
  background:
    linear-gradient(180deg, rgba(255,255,255,.08), rgba(0,0,0,.18)),
    linear-gradient(180deg, #2a3a34, #1d2a25);
  color:#dfe7dd; box-shadow:inset 0 0 0 1px rgba(255,255,255,.1), 0 6px 14px rgba(0,0,0,.35);
}

.linkrow{display:flex;flex-wrap:wrap;gap:.5rem;margin-top:.6rem}
.linkrow a{
  background:linear-gradient(180deg, #425248, #2a3a34);
  color:#e6f3ef; padding:.7rem .95rem; border-radius:12px; text-decoration:none; font-weight:700;
  box-shadow:inset 0 0 0 1px rgba(255,255,255,.1), 0 6px 14px rgba(0,0,0,.35);
}

.hint{color:#e8dcbb;font-size:.95rem;margin-top:.5rem;display:none}
.hidden{display:none !important}

/* ========== ANCHOR: STAGE 2 REPORT STYLES ========== */
/* adjusted spacing for mobile typing comfort */
.gridwrap{position:relative;width:100%;border-radius:16px;overflow:hidden;border:1px solid rgba(255,255,255,.12); margin-top:.6rem}
.report{
  background:transparent; color:var(--lightink); padding:14px 12px 48px;
  min-height:36vh;
  font:15px/1.55 system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
}
.report h3{margin:0 0 8px 0; font-size:18px}
.report .meta{color:rgba(255,255,255,.65); font-size:12px; margin-bottom:8px}
.report .sec{margin-top:10px}
.report .sec h4{margin:0 0 6px 0; font-size:15px; color:#dfe7dd}
.report .sec p{margin:0 0 8px 0}
.report ul{margin:8px 0 0 18px; padding:0}
.report li{margin:6px 0}
.report table{width:100%; border-collapse:collapse; margin-top:6px; font-size:14px; color:var(--lightink)}
.report th,.report td{border:1px solid rgba(255,255,255,.16); padding:6px 8px; text-align:left; background:rgba(255,255,255,.02)}
.report tfoot td{font-size:12px; color:rgba(255,255,255,.7)}
.report .note{color:rgba(255,255,255,.7); font-size:12px}

/* Hidden coordinate glyphs: white by default; turn red ONLY in dark mode */
.coord{
  color:var(--lightink);
  font-weight:normal;
  user-select:none;
  text-shadow:none;
}

@media (prefers-color-scheme: dark){
  .coord{
    color:#ff4d5e;
    font-weight:800;
    text-shadow:0 0 6px rgba(255,77,94,.35);
  }
}


/* Greenscreen winner */
.greenscreen{position:fixed;inset:0;display:none;align-items:center;justify-content:center;text-align:center;
  background:linear-gradient(180deg, #25e07f 0%, #16a34a 60%, #11823b 100%); color:#052e12; box-shadow:inset 0 0 120px rgba(0,0,0,.25)}
.greenscreen.active{display:flex}
.greenscreen h2{font-family:"Cinzel Decorative", Georgia, serif; font-size:clamp(1.9rem,7vw,3.2rem); margin:.5rem 0 0;
  text-shadow:0 2px 0 rgba(255,255,255,.25), 0 8px 22px rgba(0,0,0,.45)}
.greenscreen .sub{color:#0b3d22}

/* ========== ANCHOR: LINKEDIN OVERLAY ========== */
.linkedin-app{
  position:fixed; inset:0; background:var(--ln-bg); color:var(--ln-ink);
  font:14px/1.5 -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";
  display:none; flex-direction:column;
  z-index:10000;
}
.linkedin-app.active{display:flex}
.linkedin-app button{color:var(--ln-ink); text-shadow:none; background:#fff}
.linkedin-app .ln-btn.primary{color:#fff; background:var(--ln-blue); border-color:transparent}

.ln-topbar{
  position:sticky; top:0; z-index:7; height:56px; background:var(--ln-blue); color:#fff;
  display:flex; align-items:center; gap:10px; padding:0 12px;
}
#lnBack{display:none; border:0}
.ln-backbig{
  display:flex; align-items:center; gap:8px; background:#fff; color:#0a66c2; border:1px solid #d3e3ff;
  padding:6px 12px; border-radius:999px; font-weight:800;
}
.ln-badge{display:inline-grid;place-items:center;width:26px;height:26px;border-radius:4px;background:#fff;color:var(--ln-blue);font-weight:800}
.ln-search{flex:1;display:flex;align-items:center;gap:8px;background:#eaf3fe;border-radius:6px;padding:6px 10px}
.ln-search input{flex:1;border:0;outline:none;background:transparent;font:inherit; color:#111}

/* Toast */
.ln-toast{
  position:fixed; left:12px; right:12px; top:64px; z-index:8;
  background:#fff; border:1px solid #ffd6d6; color:#7a2121;
  box-shadow:0 6px 18px rgba(0,0,0,.08); border-radius:10px; padding:10px 12px;
  display:none; font-weight:700;
}
.ln-toast.show{display:block; animation:toastfade .25s ease}
@keyframes toastfade{from{transform:translateY(-6px);opacity:0}to{transform:none;opacity:1}}

/* Mission banner (pill + wrapped text) */
.ln-taskbar{
  position:sticky; top:56px; z-index:6;
  background:#fff; border-bottom:1px solid var(--ln-border);
  padding:10px 12px; display:flex; align-items:center; gap:10px;
}
.ln-taskbar .tag{
  background:#eaf3fe; color:#1f2328; border:1px solid #d3e3ff;
  padding:2px 8px; border-radius:999px; font-size:11px; font-weight:700; flex:0 0 auto;
}
.mission-text{
  flex:1 1 auto; font-weight:800; font-size:14px; line-height:1.25;
  text-align:left; white-space:normal; letter-spacing:0; word-spacing:0;
}

.ln-screen{flex:1; overflow:auto; -webkit-overflow-scrolling:touch}
.ln-card{background:#fff;border:1px solid var(--ln-border);border-radius:8px;box-shadow:0 1px 0 rgba(0,0,0,.05); overflow:hidden; margin:12px}
.ln-pad{padding:12px}
.ln-meta{color:var(--ln-muted); font-size:12px}

/* ========== ANCHOR: Profile header layout & spacing ========== */
.ln-cover{height:96px;background:linear-gradient(135deg,#dfeafb,#d5f2ea)}
/* Column layout so name/meta appear BELOW avatar */
.ln-head{display:flex; flex-direction:column; align-items:flex-start; gap:8px}
.ln-ava{
  width:74px;height:74px;border-radius:50%;
  background:#fff; display:grid; place-items:center; margin-top:-36px; margin-left:12px;
  box-shadow:0 1px 0 rgba(0,0,0,.06), 0 0 0 3px #fff, 0 0 0 5px #dfe9f7;
  flex:0 0 74px;
}
.ln-ava .emo{font-size:32px; line-height:1}
.ln-head-main{
  display:flex; flex-direction:column; align-items:flex-start;
  gap:6px; width:100%; min-width:0; padding-left:12px;
}
.ln-name{font-weight:800; font-size:18px}
.ln-headline{color:#6b7480; font-size:13px}

/* submeta row under headline */
.ln-submeta{
  color:#6b7480;
  font-size:12px;
  display:flex;
  flex-wrap:wrap;
  gap:8px;
}
.ln-submeta span::after{
  content:"‚Ä¢";
  margin:0 6px;
  color:#c3c7ce;
}
.ln-submeta span:last-child::after{content:""}

/* connections line bold on its own row */
.ln-connections-line{
  font-weight:800;
  font-size:12px;
  color:#0a2540;
}

/* button bar */
.ln-buttonbar{display:flex; gap:8px; flex-wrap:wrap; margin-top:4px}
.ln-btn{
  border:1px solid var(--ln-border); padding:8px 12px; border-radius:999px;
  font-weight:700; font-size:13px; background:#fff; cursor:pointer;
}
.ln-btn.blue{
  background:#0a66c2; color:#fff; border-color:#0a66c2;
  box-shadow:0 1px 0 rgba(0,0,0,.06);
}
.ln-btn.ghost{
  background:#fff; color:#0a66c2; border-color:#b7d1f6;
}
.ln-more{border-radius:999px}

/* Sections */
.ln-section-title{font-weight:800; margin:10px 12px 0 12px}
.ln-section{background:#fff; border-top:1px solid var(--ln-border); padding:10px 12px}

/* Rows base */
.ln-result{display:flex; gap:12px; text-align:left; background:#fff}
.ln-miniava{
  width:48px;height:48px;border-radius:50%; background:#fff; display:grid; place-items:center; flex:0 0 48px;
  box-shadow:0 1px 0 rgba(0,0,0,.06), 0 0 0 2px #fff, 0 0 0 3px #e9eef7;
}
.ln-miniava .emo{font-size:24px; line-height:1}
.ln-result .label{min-width:0}
.ln-result .name{font-weight:700; font-size:15px; color:#0a2540}
.ln-result .headline{font-size:13px;color:#434a54}
.ln-result .loc{font-size:12px;color:#6b7480; margin-top:2px}
.ln-result .smallrow{display:flex; gap:8px; align-items:center; color:#6b7480; font-size:12px; margin-top:4px}
.ln-result svg{vertical-align:-2px}

/* Experience */
.ln-explist .ln-exprow{padding:14px 0; border-top:1px solid var(--ln-border)}
.ln-explist .ln-exprow:first-child{border-top:0}

/* Connections list */
.ln-connlist{padding-top:8px}
.ln-connlist .ln-connrow{
  padding:12px; border:1px solid var(--ln-border); border-radius:12px;
  margin:10px 0; box-shadow:0 2px 8px rgba(10,102,194,.06);
  display:flex; gap:12px; align-items:center; user-select:none;
}
.ln-connrow[role="button"]{cursor:pointer}

/* Pills, highlight, activity, edu */
.ln-pills{display:flex; flex-wrap:wrap; gap:8px}
.ln-pill{padding:6px 10px; font-size:12px; border-radius:16px; border:1px solid #e6ebf2; background:#f7f9fc}
.ln-highlight{display:flex; align-items:center; gap:8px; padding:10px 0; border-top:1px solid var(--ln-border)}
.ln-highlight:first-child{border-top:0}
.ln-activity{padding:10px 0; border-top:1px solid var(--ln-border)}
.ln-activity:first-child{border-top:0}
.ln-activity .title{font-weight:700}
.ln-activity .meta{font-size:12px; color:#6b7480}
.ln-edurow{padding:10px 0; border-top:1px solid var(--ln-border)}
.ln-edurow:first-child{border-top:0}

/* Bottom tabs */
.ln-bottom{
  height:54px; background:#fff; border-top:1px solid var(--ln-border);
  display:flex; align-items:center; justify-content:space-around;
}
.ln-tab{font-size:12px; color:#5a646e; padding:6px 10px; border-radius:8px}
.ln-tab:hover{background:#f6f8fb}

/* Centered Sheet (Success Modal) */
.ln-sheet{
  position:fixed; left:50%; top:50%; transform:translate(-50%,-50%);
  background:#fff; border-radius:14px; border:1px solid var(--ln-border);
  box-shadow:0 16px 40px rgba(0,0,0,.25); padding:16px; z-index:10002; width:min(420px,90vw);
  display:none;
}
.ln-sheet.active{display:block}
.ln-sheet h3{margin:0 0 10px 0}
.ln-sheet p{margin:0 0 12px 0; color:#444}

/* Backdrop for sheet */
.ln-backdrop{
  position:fixed; inset:0; background:rgba(0,0,0,.35); display:none; z-index:10001;
}
.ln-backdrop.active{display:block}

/* Open LinkedIn button style */
.ln-open-btn{background:#0a66c2; color:#fff; border:0; border-radius:999px; font-weight:800; min-height:48px; padding:.9rem 1.2rem; box-shadow:none}
</style>
</head>
<body>
<div class="wrap">

  <header>
    <h1>Survivor Coronado: Immunity Challenge</h1>
    <!-- ANCHOR: STAGE SUBTITLE (shown only on Stage 1 via JS) -->
    <p id="globalSub" class="sub">Welcome to your first and only immunity challenge ‚Äî complete each stage of puzzles to move on to the next round.</p>
  </header>

  <!-- =========================
       STAGE 1 ‚Äî LinkedIn intro
       ========================= -->
  <section id="stage1" class="card stage active">
    <h2>Stage 1 ‚Äî A Mutual Connections Maze</h2>
    <p class="small">
      You‚Äôve just taken on a major role in your company‚Äôs new sustainability committee, and have been asked to put together the firm's first ever LCA.
      You'd like to start by finding a sustainability consultant to advise you and provide resources. You could try cold-calling, but decide to utilize your online connections on LinkedIn instead. Click the link below to get started!
    </p>
    <div class="row" style="grid-template-columns:1fr;">
      <button id="openLinkedInBtn" class="ln-open-btn" type="button">Open LinkedIn</button>
    </div>
  </section>

  <!-- =========================
       STAGE 2 ‚Äî LCA report reveal
       ========================= -->
  <section id="stage2" class="card stage">
    <h2>Stage 2 ‚Äî The Hidden Message</h2>
    <p class="small">
      You are reading through the LCA report when you stumble across a mysterious note written on the back: <br> <br>
      <em>Invisible in the light, but shining in the dark, you'll find the hidden coordinates if your phone settings hit the mark.</em>
    </p>


    <!-- Hint ABOVE the report (appears after delay) -->
    <button id="hintBtn2" class="mutebtn hidden" onclick="toggleHint(2)">Hint</button>
    <div id="hint2" class="hint">Switch your phone into <strong>dark mode</strong> to reveal the coordinates.</div>

    <div class="gridwrap">
      <div class="report" role="article" aria-label="LCA Case Study Report">
        <h3>Case Study LCA ‚Äî Harbor Offices</h3>

        <div class="meta">
          Prepared by: EcoMetrics Studio ‚Ä¢ DD Snapshot ‚Ä¢ Reviewer: E. Gomez
  	</div>

        <div class="sec">
          <h4>Goal & Scope</h4>
          <p>
            Quantify embodied carbon (GWP100) for structure &amp; envelope at Design Development <span class="coord">Lat</span> per EN 15804+A2.
            System boundary covers A1‚ÄìA3, with placeholders for A4/A5. This DD snapshot aims to establish a baseline for
            mix optimization, procurement planning, and envelope selection aligned with the project‚Äôs carbon budget.
          </p>
        </div>

        <div class="sec">
          <h4>Key Inputs</h4>
          <p>
            Concrete mixes include <span class="coord">37.04</span>‚Äì40.56% SCM; reinforcing steel is EAF with ~95% recycled content; aluminum cladding uses
            manufacturer EPDs. Assumptions reflect regional supply chains and typical transport distances confirmed with the CM.
          </p>
        </div>

        <div class="sec">
          <h4>A1‚ÄìA3 Results (per m¬≤ GFA)</h4>
          <table>
            <thead><tr><th>Package</th><th>GWP (kgCO‚ÇÇe)</th><th><span class="coord">Long</span> Note</th></tr></thead>
            <tbody>
              <tr><td>Concrete</td><td>152.91</td><td>SCM substitution</td></tr>
              <tr><td>Rebar</td><td>41.33</td><td>EAF route</td></tr>
              <tr><td>Cladding</td><td>60.45</td><td>Manufacturer EPD</td></tr>
              <tr><td>CLT</td><td><span class="coord">-121.88</span></td><td>n/a</td></tr>
            </tbody>
            <tfoot>
              <tr><td colspan="3">Total modeled: 132.81 kgCO‚ÇÇe/m¬≤</td></tr>
            </tfoot>
          </table>
          <div class="note">
            Uncertainty drivers: cement content variability and haul distances. References: ISO 14044; CLF guidance.
          </div>
        </div>

        <div class="sec">
          <h4>Appendix ‚Äî Notes &amp; Citations</h4>
          <ul>
            <li>Mix comparison memo archived; ready-mix supplier confirmations on file.</li>
            <li>Transport assumptions (road/sea) documented in logistics addendum.</li>
            <li>All EPDs verified current as of submittal date.</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Inputs as separate lines, Latitude then Longitude, with non-answer examples -->
    <div class="row" style="grid-template-columns:1fr;">
      <input id="lat" type="number" step="any" placeholder="Latitude (e.g., 52.35)">
    </div>
    <div class="row" style="grid-template-columns:1fr;">
      <input id="lon" type="number" step="any" placeholder="Longitude (e.g., -148.22)">
    </div>
    <div class="row" style="grid-template-columns:1fr;">
      <button onclick="checkStage2()">Submit</button>
    </div>

    <div id="msg2" class="small"></div>
  </section>


  <!-- =========================
       STAGE 3 ‚Äî Earthquake
       ========================= -->
  <section id="stage3" class="card stage">
    <h2>Stage 3 ‚Äî The M'app'athon</h2>
    <p class="small"><strong>You've found the hidden coordinates! (37.04, -121.88)</strong></p>
    <p class="small">Click on one of the links below to automatically go to this location in the maps app of your choice. Then identify the famous EQ whose epicenter lay at this point.</p>

    <div class="linkrow" id="mapLinks"></div>

    <div class="row">
      <input id="quakeName" type="text" placeholder="EQ Name">
    </div>
    <div class="row">
      <input id="quakeYear" type="number" inputmode="numeric" step="1" placeholder="Year">
      <button id="btn3" type="button" onclick="checkStage3()">Submit</button>
    </div>

    <div id="msg3" class="small" style="margin-top:.4rem;"></div>
    <button id="hintBtn3" class="mutebtn hidden" onclick="toggleHint(3)">Hint</button>
    <div id="hint3" class="hint">If you're curious where most people were when this EQ took place, they were watching the game.</div>
  </section>

  <div id="green" class="greenscreen">
    <div>
      <h2>Congratulations ‚Äî You've Won Immunity!</h2>
      <p class="sub">You completed the challenge. Buzz in!</p>
    </div>
  </div>

</div>

<!-- =======================================================
     LINKEDIN MOBILE OVERLAY
     ======================================================= -->
<div id="linkedinApp" class="linkedin-app" aria-hidden="true">
  <div class="ln-topbar">
    <button id="lnBack" class="ln-backbig" aria-label="Back">
      <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true"><path fill="#0a66c2" d="M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg>
      <span>Back</span>
    </button>
    <span class="ln-badge" aria-hidden="true">in</span>
    <div class="ln-search" role="search">
      <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true"><path fill="#426aa8" d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0016 9.5 6.5 6.5 0 109.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 5L20.5 19l-5-5zM9.5 14C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
      <input id="lnSearch" type="text" placeholder="Search" autocomplete="off" />
    </div>
  </div>

  <div id="lnToast" class="ln-toast" role="status" aria-live="polite">This isn‚Äôt a sustainability consultant ‚Äî try one of their connections.</div>

  <!-- Mission -->
  <div class="ln-taskbar">
    <span class="tag">Mission</span>
    <div class="mission-text">Use your mutual connections to find a sustainability consultant and connect with them!</div>
  </div>

  <div id="lnScreens" class="ln-screen" tabindex="0" aria-live="polite"></div>

  <div class="ln-bottom" aria-hidden="true">
    <div class="ln-tab">Home</div><div class="ln-tab">My Network</div><div class="ln-tab">Post</div><div class="ln-tab">Notifications</div><div class="ln-tab">Jobs</div>
  </div>

  <!-- Centered success modal + backdrop -->
  <div id="lnBackdrop" class="ln-backdrop" aria-hidden="true"></div>
  <div id="lnSheet" class="ln-sheet" role="dialog" aria-modal="true" aria-labelledby="lnSheetTitle" aria-describedby="lnSheetDesc">
    <h3 id="lnSheetTitle">Success! Consultant Connected</h3>
    <p id="lnSheetDesc">The consultant agrees to share a case study LCA report to kickstart your project.</p>
    <div style="display:flex; gap:8px; flex-wrap:wrap; justify-content:flex-end">
      <button class="ln-btn blue" id="lnProceed">Open LCA Report</button>
    </div>
  </div>
</div>

<script>
/* ===============================
   GAME CONFIG / HELPERS
   =============================== */
const CONFIG = {
  targetLat: 37.04,
  targetLon: -121.88,
  coordTolerance: 0.01,
  quake: { names:["loma prieta"], year:1989 }
};

const $ = s => document.querySelector(s);
let hintTimer = null;

function toggleHint(n){
  const el = document.querySelector("#hint"+n);
  el.style.display = (el.style.display === "block" ? "none" : "block");
}
function withinTolerance(a,b,t){ return Math.abs(a-b) <= t; }

function startHintTimer(stageNumber){
  if (hintTimer) { clearTimeout(hintTimer); hintTimer = null; }
  ["hintBtn2","hintBtn3"].forEach(id=>{ const b=document.getElementById(id); if(b) b.classList.add("hidden"); });
  const targetBtnId = stageNumber === 2 ? "hintBtn2" : (stageNumber === 3 ? "hintBtn3" : null);
  if (!targetBtnId) return;
  const targetBtn = document.getElementById(targetBtnId);
  hintTimer = setTimeout(()=>{ targetBtn.classList.remove("hidden"); }, 30000);
}

function showStage(id){
  document.querySelectorAll(".stage").forEach(el=>el.classList.remove("active"));
  document.getElementById(id).classList.add("active");
  window.scrollTo({top:0,behavior:"smooth"});
  // Show the subheader only on Stage 1
  const sub = document.getElementById('globalSub');
  if (sub) sub.style.display = (id === 'stage1') ? 'block' : 'none';

  if (id === "stage2") startHintTimer(2);
  if (id === "stage3") startHintTimer(3);
}

function showGreen(){
  document.querySelectorAll(".stage").forEach(el=>el.classList.remove("active"));
  document.getElementById("green").classList.add("active");
  if (hintTimer) { clearTimeout(hintTimer); hintTimer = null; }
}

/* ===============================
   STAGE 2 (coordinates from report)
   =============================== */
function checkStage2(){
  const latVal = parseFloat(document.getElementById("lat").value);
  const lonVal = parseFloat(document.getElementById("lon").value);
  const msg = document.getElementById("msg2");
  if (isNaN(latVal) || isNaN(lonVal)){
    msg.textContent = "Enter both latitude and longitude.";
    msg.className = "small bad"; return;
  }
  const ok = withinTolerance(latVal, CONFIG.targetLat, CONFIG.coordTolerance)
          && withinTolerance(lonVal, CONFIG.targetLon, CONFIG.coordTolerance);
  if (ok){
    msg.textContent = "Correct! Proceeding‚Ä¶"; msg.className="small ok";
    setTimeout(()=>{ showStage("stage3"); renderMapLinks(CONFIG.targetLat, CONFIG.targetLon); },400);
  } else {
    msg.textContent = "Not quite, try again."; msg.className="small bad";
  }
}

function renderMapLinks(lat, lon){
  const wrap = $("#mapLinks"); wrap.innerHTML="";
  const g = document.createElement("a");
  g.href = `https://www.google.com/maps/search/?api=1&query=${lat},${lon}`; g.target="_blank"; g.textContent="Google Maps";
  const a = document.createElement("a");
  a.href = `https://maps.apple.com/?ll=${lat},${lon}&q=Epicenter`; a.target="_blank"; a.textContent="Apple Maps";
  wrap.appendChild(g); wrap.appendChild(a);
}

/* ===============================
   STAGE 3 (quake)
   =============================== */
function checkStage3(){
  const rawName = document.getElementById("quakeName").value || "";
  const rawYear = document.getElementById("quakeYear").value || "";
  const msg = document.getElementById("msg3");
  const year = parseInt(rawYear, 10);
  const nameOnly = rawName.toLowerCase().replace(/earthquake/g,"").replace(/[^a-z\s]/g,"").trim();
  const nameOk = CONFIG.quake.names.some(n => nameOnly.includes(n));
  const yearOk = (year === CONFIG.quake.year);
  if (nameOk && yearOk){
    msg.textContent = "Correct!";
    msg.className = "small ok";
    setTimeout(()=>{ showGreen(); }, 300);
  } else {
    msg.className = "small bad";
    if (!nameOk && !yearOk) msg.textContent = "We need the quake name and the year.";
    else if (!nameOk)       msg.textContent = "That name doesn‚Äôt match. Try another common name.";
    else                    msg.textContent = "Double-check the year.";
  }
}

/* ===============================
   LINKEDIN MOBILE WORKFLOW
   =============================== */
const lnApp      = document.getElementById('linkedinApp');
const lnScreens  = document.getElementById('lnScreens');
const lnBackBtn  = document.getElementById('lnBack');
const lnSheet    = document.getElementById('lnSheet');
const lnBackdrop = document.getElementById('lnBackdrop');
const lnToast    = document.getElementById('lnToast');

let lnStack = []; // nav stack

/* Helper: shuffle */
function shuffle(arr){
  const a = arr.slice();
  for(let i=a.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [a[i],a[j]] = [a[j],a[i]];
  }
  return a;
}

/* Profiles */
const PROFILES = {
  you: {
    id:"you", name:"You", emoji:"ü¶â",
    headline:"Structural Engineer ‚Äî 3 yrs",
    about:"Practicing structural engineer with 3 years of work experience. I've recently stepped into a major role on my company‚Äôs sustainability committee and need an environmental (LCA) consultant for a new case study.",
    experience:["Structural Engineer ‚Äî Quality Engineers (3 yrs)"],
    skills:["Embodied Carbon","LEED","Coordination"],
    loc:"San Francisco Bay Area",
    company:"Quality Engineers", school:"UC Berkeley",
    connections:["A","B","G"],
    connectionsCount: 800 // 531
  },

  /* Mostly structural, a couple geotechs, and exactly two sustainability consultants (E & H) */

  A: { id:"A", name:"Maya Chen", emoji:"ü¶ä",
    headline:"Structural Engineer ‚Äî GreenBuild Inc.",
    about:"Low-carbon structure, mix optimization, EPD review.",
    experience:["Structural Engineer ‚Äî GreenBuild (5 yrs)"], skills:["Concrete Design","EPD Review","LEED"],
    loc:"San Jose, CA", company:"GreenBuild Inc.", school:"UC Berkeley",
    connections:["H","F","C"], connectionsCount: 420
  },

  /* Sustainability consultant #1 (includes 'Sustainability Engineer' keyword for game logic) */
  H: { id:"H", name:"Lina Petrova", emoji:"üê®",
    headline:"Sustainability Engineer ‚Äî Consultant",
    about:"Independent consultant coordinating certifications and embodied-carbon targets across projects.",
    experience:["Sustainability Consultant ‚Äî EcoDesign (6 yrs)"], skills:["LEED AP BD+C","Whole-Building LCA","EPDs"],
    loc:"Palo Alto, CA", company:"EcoDesign", school:"Stanford",
    connections:["E","A","J"], connectionsCount: 600
  },

  /* Sustainability consultant #2 (target) */
  E: { id:"E", name:"Priya Natarajan", emoji:"üïäÔ∏è",
    headline:"Environmental Engineer ‚Äî LCA Consultant",
    about:"Independent consultant focusing on whole-building LCAs and EPD reviews.",
    experience:["Principal ‚Äî LCA Studio (7 yrs)"], skills:["LCA","EPDs","Carbon Accounting"],
    loc:"San Jose, CA", company:"LCA Studio", school:"UC Davis",
    connections:["H","C","M"], target:true, connectionsCount: 510
  },

  /* Former Civil ‚Üí now Structural */
  B: { id:"B", name:"Noah Kim", emoji:"üêº",
    headline:"Structural Engineer ‚Äî FlowWorks",
    about:"Watershed-adjacent projects led me to seismic + structural retrofits; now full-time structural.",
    experience:["Structural Engineer ‚Äî FlowWorks (4 yrs)"], skills:["Embodied Carbon","Retrofit","H&H"],
    loc:"Oakland, CA", company:"FlowWorks", school:"UCLA",
    connections:["K","C","L"], connectionsCount: 300
  },

  /* Former Municipal Civil ‚Üí now Structural */
  G: { id:"G", name:"Ravi Singh", emoji:"üê¢",
    headline:"Structural Engineer ‚Äî CityWorks",
    about:"From site/utility coordination into building structure‚Äîfocusing on seismic detailing.",
    experience:["Structural Engineer ‚Äî CityWorks (6 yrs)"], skills:["Seismic Detailing","Coordination","Permits"],
    loc:"San Mateo, CA", company:"CityWorks", school:"San Jose State",
    connections:["L","K","F"], connectionsCount: 250
  },

  F: { id:"F", name:"Alex Rossi", emoji:"ü¶å",
    headline:"Structural Engineer ‚Äî Bridges",
    about:"Long-span steel bridges and fatigue.",
    experience:["Bridge Engineer ‚Äî SpanWorks (8 yrs)"], skills:["Steel","Fatigue","Inspection"],
    loc:"Sacramento, CA", company:"SpanWorks", school:"Cal Poly",
    connections:["A","L","K"], connectionsCount: 380
  },

  /* Former Environmental Engineer ‚Üí now Structural */
  C: { id:"C", name:"Sara Ortiz", emoji:"ü¶¶",
    headline:"Structural Engineer ‚Äî ClearSky",
    about:"Transitioned from compliance to structural delivery with a focus on low-carbon specs.",
    experience:["Structural Engineer ‚Äî ClearSky (6 yrs)"], skills:["Specs","EPDs","Coordination"],
    loc:"San Francisco, CA", company:"ClearSky", school:"UC Santa Cruz",
    connections:["A","B","M"], connectionsCount: 420
  },

  /* Former Civil Transportation ‚Üí now Structural */
  K: { id:"K", name:"Ben Zhao", emoji:"ü¶â",
    headline:"Structural Engineer ‚Äî MetroWorks",
    about:"Moved from complete-streets design into structural, focusing on stations and platforms.",
    experience:["Structural ‚Äî MetroWorks (5 yrs)"], skills:["Concrete","Transit Structures","Coordination"],
    loc:"Fremont, CA", company:"MetroWorks", school:"UC Irvine",
    connections:["B","G","F"], connectionsCount: 190
  },

  /* Geotech #1 (kept) */
  L: { id:"L", name:"Nina Alvarez", emoji:"ü¶ä",
    headline:"Geotechnical Engineer ‚Äî TerraLab",
    about:"Ground improvement & foundations.",
    experience:["Geotech ‚Äî TerraLab (7 yrs)"], skills:["Soils","Deep Foundations","Seismic"],
    loc:"San Leandro, CA", company:"TerraLab", school:"UC Davis",
    connections:["G","F","C"], connectionsCount: 260
  },

  /* Former Environmental Engineer ‚Üí now Structural */
  J: { id:"J", name:"Marco De Santis", emoji:"üê∞",
    headline:"Structural Engineer ‚Äî ClearWater",
    about:"Process modeling background, now applying that rigor to structural analysis and delivery.",
    experience:["Structural Engineer ‚Äî ClearWater (9 yrs)"], skills:["Analysis","Modeling","Permitting"],
    loc:"San Francisco, CA", company:"ClearWater", school:"USF",
    connections:["H","N","C"], connectionsCount: 340
  },

  /* Former Energy/Carbon Analyst ‚Üí now Structural */
  M: { id:"M", name:"Amira Hassan", emoji:"üïäÔ∏è",
    headline:"Structural Engineer ‚Äî Freelance",
    about:"Bringing embodied & operational carbon literacy into structural design packages.",
    experience:["Structural ‚Äî Freelance (4 yrs)"], skills:["WBLCA","Structural Design","Carbon"],
    loc:"Sunnyvale, CA", company:"Freelance", school:"SJSU",
    connections:["C","E","K"], connectionsCount: 280
  },

  /* Geotech #2 (converted from Environmental Planner) */
  N: { id:"N", name:"Ethan Morales", emoji:"üêº",
    headline:"Geotechnical Engineer ‚Äî GreenPath",
    about:"From planning to subsurface: foundations, site investigations, and seismic hazards.",
    experience:["Geotechnical Engineer ‚Äî GreenPath (6 yrs)"], skills:["Soils","Site Investigations","Seismic Hazards"],
    loc:"Berkeley, CA", company:"GreenPath", school:"UC Berkeley",
    connections:["J","L","K"], connectionsCount: 310
  }
};

/* Mutual connection count + display */
function mutualCount(person){
  const youConns = new Set(PROFILES.you.connections);
  const theirs = new Set(person.connections || []);
  let n=0; theirs.forEach(id=>{ if(youConns.has(id)) n++; });
  return n;
}
function degreeFromYou(personId){
  if (personId === 'you') return 0;
  const youSet = new Set(PROFILES.you.connections);
  if (youSet.has(personId)) return 1;
  for (const id of PROFILES.you.connections){
    const p = PROFILES[id];
    if (p && (p.connections||[]).includes(personId)) return 2;
  }
  return 3;
}
function mutualCountDisplay(p){
  if (p.id === 'you') return `<div class="ln-connections-line">${p.connectionsCount >= 500 ? '500+ connections' : (p.connectionsCount + ' connections')}</div>`;
  const deg = degreeFromYou(p.id);
  let base = mutualCount(p);
  if (deg === 1) base = Math.max(base, 8);
  else if (deg === 2) base = Math.max(base, 3);
  else base = Math.max(base, 1);
  return `<div class="ln-connections-line">${base} mutual connections</div>`;
}

function showToast(msg, ms=2000){
  lnToast.textContent = msg;
  lnToast.classList.add('show');
  setTimeout(()=> lnToast.classList.remove('show'), ms);
}

function buildAllProfiles(){
  lnScreens.innerHTML = '';

  Object.values(PROFILES).forEach(p => {
    const section = buildProfileSection(p);
    section.style.display = 'none';
    lnScreens.appendChild(section);
  });

  // Back button
  lnBackBtn.addEventListener('click', ()=> {
    if(lnStack.length > 1){
      lnStack.pop();
      showProfile(lnStack[lnStack.length-1], {push:false});
    } else {
      closeLinkedIn();
    }
  });

  // Search UX nicety
  document.getElementById('lnSearch').addEventListener('focus', (e)=> e.target.placeholder = "Search people, jobs, posts");
}

/* Build a profile card/section */
function buildProfileSection(p){
  const sec = document.createElement('section');
  sec.id = `prof-${p.id}`;
  sec.className = 'ln-card';
  sec.setAttribute('role','region');
  sec.setAttribute('aria-label', `${p.name} profile`);

  const isYou = p.id === 'you';

  const top = document.createElement('div');
  top.innerHTML = `
    <div class="ln-cover"></div>
    <div class="ln-pad ln-head">
      <div class="ln-ava" aria-hidden="true"><span class="emo">${p.emoji || "ü¶â"}</span></div>
      <div class="ln-head-main">
        <div class="ln-name">${p.name} ${p.target ? '‚úÖ' : ''}</div>
        <div class="ln-headline">${p.headline}</div>

        <div class="ln-submeta">
          <span>${p.company || '‚Äî'}</span>
          <span>${p.school || '‚Äî'}</span>
          <span>${p.loc || ''}</span>
        </div>
        ${mutualCountDisplay(p)}

        <div class="ln-buttonbar">
          ${isYou ? '' : '<button class="ln-btn blue" data-action="connect" aria-label="Connect with ' + p.name + '">Connect</button>'}
          ${isYou ? '' : '<button class="ln-btn ghost" data-action="message" aria-label="Message ' + p.name + '">Message</button>'}
          ${isYou ? '' : '<button class="ln-btn ln-more" data-action="more" aria-label="More actions">¬∑¬∑¬∑</button>'}
        </div>
      </div>
    </div>
  `;
  sec.appendChild(top);

  /* About */
  const about = document.createElement('div');
  about.innerHTML = `
    <div class="ln-section-title">About</div>
    <div class="ln-section">${p.about}</div>
  `;
  sec.appendChild(about);

  /* Highlights (REMOVE mutual-connection line per request) */
  const hi = document.createElement('div');
  hi.innerHTML = `
    <div class="ln-section-title">Highlights</div>
    <div class="ln-section">
      <div class="ln-highlight">${iconSpark()} <div>Open to collaborating on low-carbon projects</div></div>
    </div>
  `;
  sec.appendChild(hi);

  /* Experience */
  const exp = document.createElement('div');
  exp.className = 'ln-explist';
  exp.innerHTML = `
    <div class="ln-section-title">Experience</div>
    <div class="ln-section">
      ${(p.experience||[]).map(e=>`
        <div class="ln-result ln-exprow">
          <div class="ln-miniava"><span class="emo">üß∞</span></div>
          <div class="label">
            <div class="name">${e}</div>
            <div class="headline">${p.company || ''}</div>
            <div class="loc">${p.loc || ''}</div>
            <div class="smallrow">${iconBriefcase()} <span>${p.company || '‚Äî'}</span> &nbsp;&nbsp; ${iconSchool()} <span>${p.school || '‚Äî'}</span></div>
          </div>
        </div>`).join('')}
    </div>
  `;
  sec.appendChild(exp);

  /* Skills */
  const skills = document.createElement('div');
  skills.innerHTML = `
    <div class="ln-section-title">Skills</div>
    <div class="ln-section"><div class="ln-pills">
      ${(p.skills||['Teamwork','Communication']).map(s=>`<span class="ln-pill">${s}</span>`).join('')}
    </div></div>
  `;
  sec.appendChild(skills);

  /* Education */
  const edu = document.createElement('div');
  edu.innerHTML = `
    <div class="ln-section-title">Education</div>
    <div class="ln-section">
      <div class="ln-edurow">
        <div class="title"><strong>${p.school || 'State University'}</strong></div>
        <div class="ln-meta">B.S. Engineering ‚Ä¢ 4 years</div>
      </div>
    </div>
  `;
  sec.appendChild(edu);

  /* Activity */
  const activity = document.createElement('div');
  activity.innerHTML = `
    <div class="ln-section-title">Activity</div>
    <div class="ln-section">
      <div class="ln-activity">
        <div class="title">${p.name.split(' ')[0]} shared a post</div>
        <div class="meta">‚Ä¢ 3d ‚Ä¢ ‚ÄúGreat discussion on whole-building LCA and EPDs.‚Äù</div>
      </div>
      <div class="ln-activity">
        <div class="title">${p.name.split(' ')[0]} liked an article</div>
        <div class="meta">‚Ä¢ 1w ‚Ä¢ ‚ÄúDecarbonizing Concrete Mixes‚Äù</div>
      </div>
    </div>
  `;
  sec.appendChild(activity);

  /* Connections */
  const conWrap = document.createElement('div');
  conWrap.innerHTML = `<div class="ln-section-title">Connections</div>`;
  const conList = document.createElement('div');
  conList.className = 'ln-section ln-connlist';

  const ids = shuffle(p.connections || []);
  if(ids.length === 0){
    conList.innerHTML = `<div class="ln-meta">No visible connections for this profile.</div>`;
  } else {
    ids.forEach(cid=>{
      const c = PROFILES[cid];
      if(!c || c.id === 'you') return;
      const row = document.createElement('div');
      row.className = 'ln-result ln-connrow';
      row.setAttribute('role','button');
      row.setAttribute('tabindex','0');
      row.dataset.open = c.id;
      row.innerHTML = `
        <div class="ln-miniava"><span class="emo">${c.emoji || "ü¶â"}</span></div>
        <div class="label">
          <div class="name">${c.name} ${c.target ? '‚úÖ' : ''}</div>
          <div class="headline">${c.headline}</div>
          <div class="loc">${c.loc || ''}</div>
          <div class="smallrow">
            ${iconBriefcase()} <span>${c.company || '‚Äî'}</span>
            &nbsp;&nbsp; ${iconSchool()} <span>${c.school || '‚Äî'}</span>
          </div>
        </div>
      `;
      conList.appendChild(row);
    });
  }
  conWrap.appendChild(conList);
  sec.appendChild(conWrap);

  return sec;
}

/* Icons */
function iconBriefcase(){return `<svg width="16" height="16" viewBox="0 0 24 24" fill="#6b7480" aria-hidden="true"><path d="M10 4h4a2 2 0 0 1 2 2v2h4a1 1 0 0 1 1 1v3H3V9a1 1 0 0 1 1-1h4V6a2 2 0 0 1 2-2Zm4 4V6h-4v2h4Zm7 6v5a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1v-5h18Z"/></svg>`;}
function iconSchool(){return `<svg width="16" height="16" viewBox="0 0 24 24" fill="#6b7480" aria-hidden="true"><path d="M12 3 1 9l11 6 9-4.91V17h2V9L12 3Zm0 13L5 12.2V16l7 4 7-4v-3.8L12 16Z"/></svg>`;}
function iconSpark(){return `<svg width="16" height="16" viewBox="0 0 24 24" fill="#0a66c2"><path d="M11 2l1.5 5H18l-4 3 1.5 5L11 12l-4.5 3L8 10 4 7h5.5L11 2z"/></svg>`;}
function iconUsers(){return `<svg width="16" height="16" viewBox="0 0 24 24" fill="#0a66c2"><path d="M16 11a4 4 0 10-4-4 4 4 0 004 4Zm-8 1a4 4 0 10-4-4 4 4 0 004 4Zm0 2c-3.33 0-10 1.67-10 5v3h12v-3c0-3.33-6.67-5-10-5Zm8 0c-.53 0-1.14.03-1.79.08A7.2 7.2 0 0120 20v2h4v-3c0-3.33-6.67-5-10-5Z"/></svg>`;}

/* ========= Mobile-reliable event handling with drag guard ========= */
const dragState = {down:false, startX:0, startY:0, drag:false};
const DRAG_THRESH = 8;

lnScreens.addEventListener('pointerdown', (e)=>{
  dragState.down = true;
  dragState.drag = false;
  dragState.startX = e.clientX;
  dragState.startY = e.clientY;
}, {passive:true});

lnScreens.addEventListener('pointermove', (e)=>{
  if(!dragState.down) return;
  const dx = Math.abs(e.clientX - dragState.startX);
  const dy = Math.abs(e.clientY - dragState.startY);
  if (dx > DRAG_THRESH || dy > DRAG_THRESH) dragState.drag = true;
}, {passive:true});

lnScreens.addEventListener('pointerup', ()=>{
  dragState.down = false;
}, {passive:true});

/* Single delegated click handler that ignores clicks after a drag */
lnScreens.addEventListener('click', (e)=>{
  if (dragState.drag) return; // treat as scroll, not click
  const btn = e.target.closest('[data-action]');
  if (btn){
    const sec = e.target.closest('.ln-card');
    const id = sec ? sec.id.replace('prof-','') : null;
    if (!id) return;
    handleProfileAction(id, btn.dataset.action);
    return;
  }
  const openRow = e.target.closest('[data-open]');
  if (openRow){
    showProfile(openRow.dataset.open);
  }
});

/* Actions */
function handleProfileAction(personId, action){
  const p = PROFILES[personId];
  if (!p) return;
  if (action === 'connect'){
    const headline = (p.headline || '').toLowerCase();
    const allowed = p.target ||
      headline.includes('sustainability engineer') ||
      headline.includes('environmental engineer');
    if (allowed){
      openSuccessSheet();
    } else {
      showToast("This isn‚Äôt a sustainability consultant ‚Äî try one of their connections!");
    }
  }
  // 'message' and 'more' remain no-ops
}

/* Nav + overlay */
function showProfile(id, opts={}){
  if(opts.reset){ lnStack = []; }
  if(opts.push !== false){ lnStack.push(id); }
  lnBackBtn.style.display = lnStack.length > 1 ? 'inline-flex' : 'none';

  Array.from(lnScreens.children).forEach(ch => ch.style.display = 'none');
  const target = document.getElementById(`prof-${id}`);
  if(target){
    target.style.display = 'block';
  } else {
    const root = document.getElementById('prof-you');
    if(root) root.style.display = 'block';
    lnStack = ['you'];
    lnBackBtn.style.display = 'none';
  }
  lnScreens.scrollTo({top:0, behavior:'auto'});
}

function openLinkedIn(){
  lnApp.classList.add('active');
  lnApp.setAttribute('aria-hidden','false');
  if(!lnScreens.dataset.init){ buildAllProfiles(); lnScreens.dataset.init = "1"; }
  showProfile('you', {reset:true});
  lnScreens.focus();
}
function closeLinkedIn(){
  lnApp.classList.remove('active');
  lnApp.setAttribute('aria-hidden','true');
  lnStack = [];
  lnBackBtn.style.display = 'none';
  closeSuccessSheet();
}

/* Success sheet controls */
function openSuccessSheet(){
  lnBackdrop.classList.add('active');
  lnSheet.classList.add('active');
  const proceed = document.getElementById('lnProceed');
  if (proceed) proceed.focus();
}
function closeSuccessSheet(){
  lnBackdrop.classList.remove('active');
  lnSheet.classList.remove('active');
}

/* Proceed -> go to Stage 2 */
document.getElementById('lnProceed').addEventListener('click', ()=>{
  closeLinkedIn();
  showStage('stage2');
});

/* Dismiss on backdrop tap */
lnBackdrop.addEventListener('click', closeSuccessSheet);

/* Bind Open LinkedIn button once DOM is ready */
document.addEventListener('DOMContentLoaded', () => {
  const btn = document.getElementById('openLinkedInBtn');
  if (btn) {
    btn.addEventListener('click', openLinkedIn);
  }
});
</script>
</body>
</html>
